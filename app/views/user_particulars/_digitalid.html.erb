<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <% if @user_particular.present? %>
    <script>
      $(document).ready(function() {
        // When the modal is opened
        $('#verificationWarningModal').on('shown.bs.modal', function () {
        $('body').css('overflow', 'hidden'); // Prevent scrolling when modal is open
        });
        // When the modal is closed
        $('#verificationWarningModal').on('hidden.bs.modal', function () {
        $('body').css('overflow', 'hidden'); // Re-enable scrolling when modal is closed
        });
        $('#generate-2fa-btn').click(function(e) {
          e.preventDefault();
          console.log('HELLO');
          $.ajax({
            url: '<%= generate_2fa_path(@user_particular) %>',
            type: 'POST',
            dataType: 'json',
            headers: {
              'X-CSRF-Token': $('meta[name="csrf-token"]').attr('content')
            },
            success: function(data) {
              $('#two-fa-passcode').text(data.two_fa_passcode);
            },
            error: function(xhr, status, error) {
              console.error('AJAX Error:', status, error);
            }
          });
        });
      });
    </script>
  <% end %>
</head>
<body>
  <div class="container d-flex justify-content-center p-0">
    <div class="card-1">
      <div class="card-1-header">
        EnableID Digital Card
        <% if @user_particular.nil? %>
          <%= link_to new_user_particular_path(@user_particular), class: "edit-link-right-align edit-icon-link" do %>
          <% end %>
              <% else %>
                  <%= link_to edit_user_particular_path(@user_particular), class: "edit-link-right-align edit-icon-link" do %>
                    <i class="fas fa-edit"></i>
                  <% end %>
                  <% end %>
      </div>


      
      <div class="card-1-body">
        <% if @user_particular.nil? %>
        <div class="overlayhome">
        <div style="display: flex; justify-content: center; align-items: center; height: 400px;">
          <%= link_to "Fill in your particulars to get your Digital ID!", new_user_particular_path, class: "btn btn-danger big-btn high-z-index-btn", id: "fill-in-particulars-btn" %>
        </div>          
      </div>              
      <% else %>
      <% end %>   
        <div class="photo-1">
          <%= image_tag 'default.png', alt: "Default image", class: 'profile-image' %>
        </div>
        <!--table for name and UID-->   
        <div class="details-1 px-3">
          <table>
            <tr>
                <td colspan="2"><strong>Full Name:</strong></td>
            </tr>
            <tr>
                <td colspan="2"><%= @user_particular&.full_name.present? ? @user_particular.full_name : "<br>".html_safe %></td>
            </tr>
            <tr>
                <td colspan="2"><strong>Unique Identifier:</strong></td>
            </tr>
            <tr>
                <td colspan="2"><%= @user_particular&.unique_id || "" %></td>
            </tr>
          </table>
          <!--table for others--> 
          <div class= "section">
            <table class="bordered-table">
            <tr>
                <td colspan="2"><strong>Gender:</strong></td>
                <td colspan="2"><strong>Date of Birth:</strong></td>
            </tr>
            <tr>
                <td colspan="2"><%= @user_particular&.gender.present? ? @user_particular.gender : "<br>".html_safe %></td>
                <td colspan="2"><%= @user_particular&.date_of_birth.present? ? @user_particular.date_of_birth.strftime("%d-%m-%Y") : "<br>".html_safe %></td>
            </tr>
            <tr>
                <td colspan="2"><strong>Ethnicity:</strong></td>
                <td colspan="2"><strong>Date of Arrival:</strong></td>
            </tr>
            <tr>
                <td colspan="2"><%= @user_particular&.ethnicity.present? ? @user_particular.ethnicity : "<br>".html_safe %></td>
                <td colspan="2"><%= @user_particular&.date_of_arrival.present? ? @user_particular.date_of_arrival.strftime("%d-%m-%Y") : "<br>".html_safe %></td>
            </tr>
            <tr>
                <td colspan="2"><strong>Religion:</strong></td>
                <td colspan="2"><strong>Phone Number:</strong></td>
            </tr>
            <tr>
                <td colspan="2"><%= @user_particular&.religion.present? ? @user_particular.religion : "<br>".html_safe %></td>
                <td colspan="2"><%= "+#{@user_particular&.full_phone_number&.gsub('-', '') || ''}" %></td>
            </tr>
            <tr>
                <td colspan="2"><strong>Country of Origin:</strong></td>
                <td colspan="2"><strong>Secondary Phone Number:</strong></td>
            </tr>
            <tr>
                <td colspan="2"><%= @user_particular&.country_of_origin || "" %></td>
                <td colspan="2"><%= "+#{@user_particular&.secondary_phone_number&.gsub('-', '') || ''}" %></td>
            </tr>
        </table>
          </div>
        </div>
      </div>
     
      <div class="card-footer">
        EnableID - Pending Verification from an NGO <i class="custom-verified fas fa-check"></i><%= image_tag 'qrcode.png', alt: "QR Code", class: 'img-fluid qr-code'%>   
      </div>
    </div>
  </div>
</body>
